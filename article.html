<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="jslib/layui/css/layui.css">
    <link rel="stylesheet" href="css/main.css">
    <title>贷财行SEO资讯管理后台系统</title>
</head>
<body class="layui-layout-body container">
    <div class="layui-layout layui-layout-admin">
        <!-- 头部区域 -->
        <div class="layui-header">
            <h1 class="layui-logo">贷财行SEO资讯管理后台系统</h1>
            <div class="layui-logo layui-logo-sub">欢迎用户超级管理员登录使用！</div>
            <ul class="layui-nav layui-layout-right">
                <li class="layui-nav-item">
                    <a href="javascript:;">
                        管理员：<span>名字</span>
                    </a>
                </li>
                <li class="layui-nav-item"><a href="javascript:;" onclick="$('.mask-psw').show()">修改密码</a></li>
                <li class="layui-nav-item"><a href="login.html">退出</a></li>
            </ul>
        </div>
        <!-- 左侧导航区域 -->
        <div class="layui-side ">
            <div class="layui-side-scroll">
                <ul class="layui-nav layui-nav-tree" lay-filter="test">
                    <li class="layui-nav-item">
                        <a class="" href="index.html">频道管理</a>
                    </li>
                    <li class="layui-nav-item">
                        <a href="column.html">栏目管理</a>
                    </li>
                    <li class="layui-nav-item layui-this"><a href="article.html">文章管理</a></li>
                    <li class="layui-nav-item"><a href="tag.html">标签管理</a></li>
                </ul>
            </div>
        </div>
        <!-- 右侧内容区域 -->
        <div class="layui-body article-body">
            <h2 class="layui-body-title">
                文章管理
            </h2>
            <div class="search-form">
                <div class="layui-form ">
                    <div class="layui-form-item  ">
                        <label class="layui-form-label ">文章名称：</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item  ">
                        <label class="layui-form-label ">标题：</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <!--  <div class="layui-form-item  ">
                        <label class="layui-form-label ">文章内容：</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
                        </div>
                    </div> -->
                    <button class="layui-btn layui-btn-normal">搜索</button>
                    <button class="layui-btn reset-btn">重置</button>
                    <button class="layui-btn layui-btn-danger fl-r" onclick="location.href='article_new.html'">+ 新增</button>
                </div>
            </div>
            <div class="content tag-content">
                <table id="tableBox" lay-filter="tableBox"></table>
            </div>
        </div>
    </div>
    <script src="jslib/jquery/jquery.min.js"></script>
    <script src="jslib/layui/layui.js"></script>
    <script src="js/main.js"></script>
    <script>
    layui.use(['element', 'table', 'layer', 'form'], function() {
        var element = layui.element,
            table = layui.table,
            layer = layui.layer,
            form = layui.form,
            $ = layui.jquery;
        // 表格
        var tableIns = table.render({
            elem: "#tableBox",
            url: 'http://10.10.67.5:9902/seoInformation/article/listByPage',
            cols: [
                [ //表头
                    { field: 'index', title: '序号', sort: true },
                    { field: 'name', title: '文章名称' },
                    { field: 'column', title: '所属栏目' },
                    { field: 'tags', title: '文章标签' },
                    { field: 'recommend', title: '是否推荐' },
                    { field: 'readingNum', title: '阅读数', sort: true },
                    { field: 'createUid', title: '创建人' },
                    { field: 'createTime', title: '创建时间', sort: true },
                    { field: 'updateTime', title: '上架时间', sort: true },
                    { field: 'state', title: '状态' },
                    { field: 'admin', title: '操作', minWidth: 200, align: 'center', toolbar: '#barDemo' }
                ]
            ],
            page: true,
            skin: 'line',
            request: {
                pageName: 'pageNum',
                limitName: 'pageSize'
            },
            id: "tableBoxTest",
            // 渲染回调
            done: function(res) {
                // 推荐
                $("[data-field='recommend']").children().each(function() {
                    if ($(this).text() == '0') {
                        $(this).text("否")
                    } else if ($(this).text() == '1') {
                        $(this).text("是")
                    }
                })
                // 状态
                $("[data-field='state']").children().each(function() {
                    if ($(this).text() == '0') {
                        $(this).text("下架")
                    } else if ($(this).text() == '1') {
                        $(this).text("上架")
                    }
                })
            }
        })
        //监听工具条-上下架-修改-删除
        table.on('tool(tableBox)', function(obj) {
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象
            if (layEvent === 'up') { //下架
                layer.confirm('确定进行上架吗？', function(index) {
                    ajaxBox({ id: data.id }, '/article/up', 'article.html')
                });
            } else if (layEvent === 'down') { //下架
                layer.confirm('确定进行下架吗？', function(index) {
                    ajaxBox({ id: data.id }, '/article/down', 'article.html')
                });
            } else if (layEvent === 'del') { //删除
                layer.confirm('真的删除行么', function(index) {
                    ajaxBox({ id: data.id }, '/article/remove')
                    obj.del();
                    layer.close(index);
                });
            } else if (layEvent === 'edit') { //编辑
            }
        });
        // 搜索
        // 重置
        $(".reset-btn").on("click", function() {
            tableIns.reload({
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        })
    });
    </script>
    <!-- 工具条 -->
    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="up">上架</a>
        <a class="layui-btn layui-btn-xs layui-btn-normal" lay-event="down">下架</a>
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>
</body>
</html>