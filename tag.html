<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="jslib/layui/css/layui.css">
    <link rel="stylesheet" href="css/main.css">
    <title>贷财行SEO资讯管理后台系统</title>
</head>

<body class="layui-layout-body container">
    <div class="layui-layout layui-layout-admin">
        <!-- 头部区域 -->
        <div class="layui-header">
            <h1 class="layui-logo">贷财行SEO资讯管理后台系统</h1>
            <div class="layui-logo layui-logo-sub">欢迎用户超级管理员登录使用！</div>
            <ul class="layui-nav layui-layout-right">
                <li class="layui-nav-item">
                    <a href="javascript:;">
                        管理员：<span>名字</span>
                    </a>
                </li>
                <li class="layui-nav-item"><a href="javascript:;" onclick="$('.mask-psw').show()">修改密码</a></li>
                <li class="layui-nav-item"><a href="login.html">退出</a></li>
            </ul>
        </div>
        <!-- 左侧导航区域  -->
        <div class="layui-side ">
            <div class="layui-side-scroll">
                <ul class="layui-nav layui-nav-tree" lay-filter="test">
                    <li class="layui-nav-item">
                        <a class="" href="index.html">频道管理</a>
                    </li>
                    <li class="layui-nav-item">
                        <a href="column.html">栏目管理</a>
                    </li>
                    <li class="layui-nav-item"><a href="article.html">文章管理</a></li>
                    <li class="layui-nav-item layui-this"><a href="tag.html">标签管理</a></li>
                </ul>
            </div>
        </div>
        <!-- 右侧内容区域 -->
        <div class="layui-body tag-body">
            <h2 class="layui-body-title">
                标签管理
            </h2>
            <div class="search-form">
                <div class="layui-form ">
                    <div class="layui-form-item  ">
                        <label class="layui-form-label ">标签：</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input search-input">
                        </div>
                    </div>
                    <button class="layui-btn layui-btn-normal search-btn">搜索</button>
                    <button class="layui-btn reset-btn">重置</button>
                    <button class="layui-btn layui-btn-danger fl-r" onclick="$('.mask-tag').show()">+ 新增</button>
                </div>
            </div>
            <div class="content tag-content">
                <table id="tableBox" lay-filter="tableBox"></table>
            </div>
        </div>
         <div class="mask  mask-psw">
            <div class="mask-bg"></div>
            <div class="mask-container">
                <h2>修改密码
                <i class="btn-x closeMask"></i>
                </h2>
                <form class="layui-form ">
                    <div class="layui-form-item">
                        <label class="layui-form-label">原密码：</label>
                        <div class="layui-input-block">
                            <input type="text" name="sourcePassword" required lay-verify="required" placeholder="请输入原密码" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">新密码：</label>
                        <div class="layui-input-block">
                            <input type="text" name="modifiedPassword" required lay-verify="required" placeholder="请输入新密码" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item ">
                        <label class="layui-form-label">重复密码：</label>
                        <div class="layui-input-block">
                            <input type="text" name="modifiedPasswordTwo" required lay-verify="required" placeholder="请再次输入新密码" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="mask-btn-box">
                        <button class="layui-btn layui-btn-normal" lay-submit lay-filter="pswBtn">修改密码</button>
                        <div class="layui-btn layui-btn-primary closeMask">取消</div>
                    </div>
                </form>
            </div>
        </div>
        <div class="mask  mask-tag">
            <div class="mask-bg"></div>
            <div class="mask-container">
                <h2><span>新增标签</span>
                <i class="btn-x closeMask"></i>
                </h2>
                <form class="layui-form ">
                    <div class="layui-form-item  ">
                        <label class="layui-form-label "><i class="required">*</i>名称：</label>
                        <div class="layui-input-block">
                            <input type="text" name="name" required lay-verify="required" placeholder="请输入名称" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item ">
                        <label class="layui-form-label">标题：</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" placeholder="请输入名称" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item ">
                        <label class="layui-form-label">关键词：</label>
                        <div class="layui-input-block">
                            <input type="text" name="keyword" placeholder="请输入名称" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">描述：</label>
                        <div class="layui-input-block">
                            <input type="text" name="desc" placeholder="请输入摘要" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="mask-btn-box">
                        <button class="layui-btn layui-btn-normal" lay-submit lay-filter="tagBtn">确定</button>
                        <div class="layui-btn layui-btn-primary closeMask">取消</div>
                    </div>
                </form>
            </div>
        </div>
        <div class="mask  mask-tag-edit">
            <div class="mask-bg"></div>
            <div class="mask-container">
                <h2><span>修改标签</span>
                <i class="btn-x closeMask"></i>
                </h2>
                <form class="layui-form ">
                    <div class="layui-upload hide">
                        <label class="layui-form-label">id：</label>
                        <div class="layui-upload-list">
                            <input type="text" name="id" placeholder="请输入描述" autocomplete="off" class="layui-input ">
                        </div>
                    </div>
                    <div class="layui-form-item  ">
                        <label class="layui-form-label "><i class="required">*</i>ID：</label>
                        <div class="layui-input-block">
                            <input type="text" name="name" required lay-verify="required" placeholder="请输入ID" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item ">
                        <label class="layui-form-label">标题：</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" placeholder="请输入名称" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item ">
                        <label class="layui-form-label">关键词：</label>
                        <div class="layui-input-block">
                            <input type="text" name="keyword" placeholder="请输入名称" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">描述：</label>
                        <div class="layui-input-block">
                            <input type="text" name="desc" placeholder="请输入摘要" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="mask-btn-box">
                        <button class="layui-btn layui-btn-normal" lay-submit lay-filter="tagEditBtn">确定</button>
                        <div class="layui-btn layui-btn-primary closeMask">取消</div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="jslib/jquery/jquery.min.js"></script>
    <script src="jslib/layui/layui.js"></script>
    <script src="js/main.js"></script>
    <script>
    layui.use(['element', 'layer', 'form', 'table'], function() {
        var element = layui.element,
            layer = layui.layer,
            form = layui.form,
            table = layui.table,
            $ = layui.jquery;
        // 表格
        var tableIns = table.render({
            elem: "#tableBox",
            url: ajaxUrl + '/tag/listByPage',
            cols: [
                [ //表头
                    { field: 'id', title: '序号', sort: true },
                    { field: 'name', title: '标签名称' },
                    { field: 'createUid', title: '创建人' },
                    { field: 'createTime', title: '创建时间', sort: true },
                    { title: '操作', minWidth: 150, align: 'center', toolbar: '#barDemo' }
                ]
            ],
            page: true,
            skin: 'line',
            request: {
                pageName: 'pageNum',
                limitName: 'pageSize'
            },
            id: "tableBoxTest"
        })
        //监听工具条-查看-修改-删除
        table.on('tool(tableBox)', function(obj) {
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象
            if (layEvent === 'del') { //删除
                layer.confirm('真的删除行么', function(index) {
                    ajaxBox({ id: data.id }, '/tag/remove')
                    obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                    layer.close(index);
                });
            } else if (layEvent === 'edit') { //编辑
                $('.mask-tag-edit').show();
                $('.mask-tag-edit').find('input[name$="id"]').val(data.id);
                $('.mask-tag-edit').find('input[name$="name"]').val(data.name);
                $('.mask-tag-edit').find('input[name$="title"]').val(data.title);
                $('.mask-tag-edit').find('input[name$="keyword"]').val(data.keyword);
                $('.mask-tag-edit').find('input[name$="desc"]').val(data.desc);
                //同步更新缓存对应的值
                // obj.update({
                //     username: '123',
                //     title: 'xxx'
                // });
            }
        });
        // ----------编辑项目
        // 提交
        form.on('submit(tagEditBtn)', function(data) {
            ajaxBox(data.field, "/tag/modify", "tag.html")
            return false;
        });
        // ----------新增项目
        // 提交
        form.on('submit(tagBtn)', function(data) {
            ajaxBox(data.field, "/tag/create", "tag.html")
            return false;
        });
        // ----------搜索-重置项目    
        // 搜索
        $(".search-btn").on("click", function() {
            tableIns.reload({
                // 设定后台交互的参数
                where: {
                    name: $(".search-input").val(),
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        })
        // 重置
        $(".reset-btn").on("click", function() {
            tableIns.reload({
                 where: {
                    name:'',
                },
                page: {
                    curr: 1 
                }
            });
        })
        // 修改密码
        form.on('submit(pswBtn)', function(data) {
            ajaxBox(data.field, "/api/account/modifyPassword", "index.html")
            return false;
        });
    });
    </script>
    <!-- 工具条 -->
    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>
</body>

</html>